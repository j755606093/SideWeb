<!DOCTYPE html>
<html lang="zh_cn">

<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="IE=edge" http-equiv="X-UA-Compatible" />
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
  <meta name="format-detection" content="telephone=no, email=no" />
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://ok82gyrdp.qnssl.com/css/app/mint.css">
  <title>揭西大巴订票平台票务--我的</title>
</head>

<body>
  <div id="server_break" style="display: none;text-align: center;margin-top: 50px;">
    <img style="width:200px;height:200px;margin-top: 50px;" src="../picture/server_break.png">
    <p style="color:#999;font-size: 20px;margin-top: 50px;">服务器走丢了,工程师正努力寻找中...</p>
    <a style="color:#2196F3;font-size: 20px;margin-top: 50px;display: block;" href="./ticket.html">回到主页</a>
  </div>
  <div id="app" v-show="ready" style="display: none;">
    <!-- 头部 -->
    <header class="animated fadeIn" v-show="showHeader">
      <!-- 返回键 -->
      <div @click="GoBack" class="left">
        <img src="../picture/back_icon.png">
      </div>
      <!-- 标题 -->
      <div class="home">
        <span v-text="headerTitle"></span>
      </div>
    </header>
    <div class="body">
      <!-- 页面头部 -->
      <div class="header">
        <img src="../picture/user_bg.png">
        <div @click="showUserInfo" class="left content">
          <p class="nowrap" v-text="UserInfo.Nickname"></p>
          <span v-text="UserInfo.Alias_Id"></span>
          <span>查看并编辑个人信息</span>
        </div>
        <div class="right content">
          <img :src="UserInfo.Headimgurl">
        </div>
      </div>
      <!-- 其中的列表 -->
      <div class="lists">
        <div @click="showOrderList()" class="linestyle">
          <p>全部订单</p>
          <div><img src="../picture/orders_gray.png"></div>
        </div>
        <div @click="showDiscountList" class="linestyle">
          <p>优惠券</p>
          <div><img src="../picture/coupon_gray.png"></div>
        </div>
        <div @click="showGetMoney" class="linestyle">
          <p>提取佣金</p>
          <div><img src="../picture/get_money.png"></div>
        </div>
        <div @click="showPassengerList" class="linestyle">
          <p>常用联系人</p>
          <div><img src="../picture/contact_person_gray.png"></div>
        </div>
        <a href="tel:0663-5519299" class="linestyle">
          <p>联系客服</p>
          <div><img src="../picture/phone_gray.png"></div>
        </a>
        <div @click="helpCenter" class="linestyle">
          <p>帮助中心</p>
          <div><img src="../picture/question_gray.png"></div>
        </div>
      </div>
    </div>
    <div style="height:60px;width:100%;"></div>
    <!-- 全部订单信息 -->
    <mt-popup v-model="orderVisible" position="right" id="order-lists" class="order-lists">
      <div class="lists">
        <div class="order-lists-header">
          <span @click="showOrderList()" :class="UseOrderType===0?'active':''">全部订单</span>
          <span @click="showOrderList(1)" :class="UseOrderType===1?'active':''">待支付</span>
          <span @click="showOrderList(2)" :class="UseOrderType===2?'active':''">已支付</span>
          <span @click="showOrderList(3)" :class="UseOrderType===3?'active':''">退款</span>
        </div>
        <!-- 订单 -->
        <div v-show="!refundVisible" id="refund-lists" class="refund-lists">
          <div class="list">
            <div v-if="UseOrderType===0||!(item.IsPay===1&&item.Status===3)" @click="openOrder(index)" v-for="(item,index) in OrderList" class="ticket-info">
              <div class="left">
                <span v-text="item.Boardtime">08:23</span>
                <span v-text="item.CoName">东方快车</span>
                <span>{{item.Route}}</span>
              </div>
              <div class="center">
                <canvas class="canvas-top" width="36" height="20"></canvas>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <canvas class="canvas-bottom" width="36" height="20"></canvas>
              </div>
              <div class="right">
                <div class="top">
                  <div class="name">
                    <p>{{item.StartPoint}}</p>
                    <p>{{item.EndPoint}}</p>
                  </div>
                  <div class="info">
                    <p><span style="font-size:12px;">¥</span>{{item.TotalPrice}}</p>
                    <p style="color:#f35252">{{item.StatusExplain}}</p>
                    <!-- <p style="color:#f35252" v-if="item.IsPay===1&&item.Status===0">已申请退款(全部)</p>
                    <p style="color:#f35252" v-if="item.IsPay===0&&item.Status===0">已失效</p>
                    <p style="color:#f35252" v-if="item.IsPay===0&&item.Status===1">待支付</p>
                    <p style="color:#329be8;" v-if="item.IsPay===1&&item.Status===1">待出票</p>
                    <p style="color:#329be8;" v-if="item.IsPay===1&&item.Status===2">待使用</p> -->
                    <!-- 订票失败(显示退款成功) -->
                    <!-- <p style="color:#f35252" v-if="item.IsPay===1&&item.Status===3">退款成功</p>
                    <p style="color:#f35252" v-if="item.IsPay===1&&item.Status===4">已验票</p> -->
                  </div>
                </div>
                <div class="bottom">
                  <img src="../picture/time.png">
                  <p>{{item.Boarddate}}</p>
                </div>
              </div>
            </div>
          </div>
          <div id="last"></div>
        </div>
        <!-- 退款订单 -->
        <div v-show="refundVisible" id="refund-lists" class="refund-lists">
          <div class="lists">
            <!-- 列表 -->
            <a class="list" v-for="(item,index) in RefundOrder.RefundList" :href="'https://ticket.samecity.com.cn/wx/TicketOrder.html?type=3&orderid='+item.OrderId">
              <!-- <a class="list" v-for="(item,index) in RefundOrder.RefundList" href="##"> -->
              <div class="left">
                <div class="left-line">
                  <span class="left-span">订单号:</span>
                  <span class="nowrap" v-text="item.OrderId"></span>
                </div>
                <div class="left-line">
                  <span class="left-span">退款理由:</span>
                  <span class="nowrap" v-text="item.Remark"></span>
                </div>
                <div class="left-line">
                  <span class="left-span">审核回复:</span>
                  <span class="nowrap" v-text="item.Reply?item.Reply:'未回复'"></span>
                </div>
                <div class="left-line">
                  <span class="left-span">申请状态:</span>
                  <template v-if="item.Status===0">
                    <span class="red">审核不过</span>
                  </template>
                  <template v-if="item.Status===1">
                    <span class="blue">审核中</span>
                  </template>
                  <template v-if="item.Status===2">
                    <span class="blue">审核通过待退款</span>
                  </template>
                  <template v-if="item.Status===3">
                    <span class="blue">已退款</span>
                  </template>
                </div>
              </div>
              <div class="right">
                <template v-if="item.Status===0">
                  <img src="../picture/shenhebuguo.png" class="checking">
                </template>
                <template v-if="item.Status===1">
                  <img src="../picture/shenhe.png" class="checking">
                </template>
                <template v-if="item.Status===2">
                  <img src="../picture/shenhetongguo.png" class="checking">
                </template>
                <template v-if="item.Status===3">
                  <img src="../picture/refund.png" class="checking">
                </template>
              </div>
            </a>
          </div>
          <div id="last_refund"></div>
        </div>
      </div>
    </mt-popup>
    <!-- 优惠券 -->
    <mt-popup v-model="discountVisible" position="right" class="action-page">
      <slot>
        <div class="action">
          <!-- 有优惠券 -->
          <div v-if="Rebate.length!==0" class="action-use">
            <div style="padding-top: 5px;" class="page">
              <!-- 可用优惠券 -->
              <div class="rebate" v-for="(item,index) in Rebate">
                <div class="top">
                  <img src="../picture/rebate_bg.png">
                </div>
                <div class="bottom">
                  <div class="left">
                    <p><span>¥</span>{{item.Money}}</p>
                    <p class="limit">{{'满'+item.LimitMoney+'元可用'}}</p>
                    <p class="name">{{item.Name}}</p>
                    <p class="time">{{item.StartDate.slice(0,10)}} 至 {{item.EndDate.slice(0,10)}}</p>
                  </div>
                  <div class="right">
                    <a :href="'https://ticket.samecity.com.cn/wx/ticket.html?rebateid='+item.Id">立即使用</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- 没有优惠券 -->
          <div v-else class="action-use">
            <div style="width: 100%;height: 200px;display: flex;justify-content: center;align-items: center;">
              <img src="../picture/norebate.png">
            </div>
            <p style="width: 100%;text-align: center;color: #999;font-size: 18px;">这里空空如也~</p>
          </div>
        </div>
      </slot>
    </mt-popup>
    <!-- 提取佣金 -->
    <mt-popup v-model="getmoneyVisible" position="right" id="money-lists" class="money-lists">
      <div class="money-body">
        <div id="money__list"></div>
        <div style="height:50px;background-color: #329be8"></div>
        <div class="money-header">
          <div class="money-header-top">
            <div class="money-left money-block">
              <p class="first"><span>¥</span>{{getMoneyUseData.TotalBkge}}</p>
              <p class="last">佣金总数</p>
            </div>
            <div class="money-center money-block">
              <p class="first"><span>¥</span>{{getMoneyUseData.ReceiveBkge}}</p>
              <p class="last">可领取佣金</p>
            </div>
            <div class="money-right money-block">
              <p class="first"><span>¥</span>{{getMoneyUseData.UndoneBkge}}</p>
              <p class="last">尚未完成金额</p>
            </div>
          </div>
          <div class="money-header-bottom">
            <button @click="applyGetMoney" class="getmoney">申请提现</button>
          </div>
        </div>
        <div class="money-list">
          <div class="people-list" v-for="(item,index) in getMoneyData">
            <div class="img">
              <img :src="item.Avatar">
            </div>
            <div class="name">
              <p>{{item.Nick}}</p>
            </div>
            <div class="taskname">
              <template v-if="item.Status===0">
                <p>已关注</p>
              </template>
              <template v-if="item.Status===1">
                <p>已购票/将获得{{item.Brokerage}}元佣金</p>
              </template>
              <template v-if="item.Status===2">
                <p>已完成交易/将获得{{item.Brokerage}}元佣金</p>
              </template>
            </div>
          </div>
        </div>
        <!-- 用来判断是否接近底部 -->
        <div id="money_last"></div>
      </div>
    </mt-popup>
    <!-- 乘客 -->
    <mt-popup v-model="passengerVisible" position="right" class="action-page">
      <slot>
        <div class="action">
          <div class="action-select">
            <div v-for="(item,index) in Passenger">
              <div class="line">
                <div class="left">
                  <p>{{item.Name}}</p>
                </div>
                <div class="center">
                  <p>{{item.Mobile}}</p>
                </div>
                <div @click="showChaPassenger(index)" class="right"><img src="../picture/edit.png"></div>
              </div>
            </div>
          </div>
          <p class="refresh">没有乘客信息?来下面添加吧~ </p>
          <div class="action-body">
            <!-- 点击新增乘客 -->
            <div class="write-info">
              <div @click="showAddPassenger" class="line">
                <span>添加新乘车人</span>
                <div class="img"><img src="../picture/add_passenger.png"></div>
              </div>
            </div>
          </div>
        </div>
      </slot>
    </mt-popup>
    <!-- 修改乘客信息 -->
    <mt-popup v-model="isShowChangePassenger" class="change-page">
      <slot>
        <div class="change-page-body">
          <!-- 修改乘客信息 -->
          <div style="padding:10px" v-show="showpassengeraction===2" class="add-action animated zoomIn">
            <div class="line-header">
              <span>修改乘客信息</span>
            </div>
            <div class="line change">
              <input type="text" v-model="passengerName" name="passengerName" placeholder="请填写真实姓名">
            </div>
            <div class="line change">
              <input type="text" v-model="passengerPhone" name="passengerPhone" placeholder="手机号选填(可用于联系)">
            </div>
            <div class="line-btn">
              <button @click="hideChangePassenger" class="left-btn">取消</button>
              <button class="right-btn" @click="addPassenger(1)">确定</button>
            </div>
          </div>
          <!-- 增加乘客信息 -->
          <div style="padding:10px" v-show="showpassengeraction===1" class="add-action animated zoomIn">
            <div class="line-header">
              <span>增加乘客信息</span>
            </div>
            <div class="line change">
              <input type="text" v-model="passengerName" name="passengerName" placeholder="请填写真实姓名">
            </div>
            <div class="line change">
              <input type="text" v-model="passengerPhone" name="passengerPhone" placeholder="手机号选填(可用于联系)">
            </div>
            <div class="line-btn">
              <button @click="hideChangePassenger" class="left-btn">取消</button>
              <button class="right-btn" @click="addPassenger(0)">确定</button>
            </div>
          </div>
        </div>
      </slot>
    </mt-popup>
    <!-- 用户信息 -->
    <mt-popup v-model="userVisible" position="right" id="user-lists" class="user-lists">
      <div class="lists">
        <div class="info-man">
          <div class="info-man-line info">
            <span class="left">ID:</span>
            <span class="gray" style="flex:0.7;" v-text="UserInfo.Alias_Id"></span>
          </div>
          <div @click="edit(0)" class="info-man-line info">
            <span class="left">昵称:</span>
            <span class="gray" v-text="UserInfo.Nickname"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
          <div @click="showCodePage" class="info-man-line info">
            <span class="left">绑定手机:</span>
            <span class="gray" v-text="UserInfo.Mobile?UserInfo.Mobile:'未设置'"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
          <div @click="edit(3)" class="info-man-line info">
            <span class="left">性别:</span>
            <span class="gray" v-text="UserInfo.Sex===1?'男':'女'"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
          <div class="update--info">
            <button @click="updateUserInfo">同步微信信息</button>
            <p>若您最近更新了微信头像等信息,建议您同步最新数据以免显示不准确~</p>
          </div>
        </div>
      </div>
    </mt-popup>
    <!-- 帮助中心 -->
    <mt-popup v-model="helpVisible" position="right" id="help-lists" class="help-lists">
      <div class="lists">
        <!-- 列表 -->
        <div class="help">
          <div class="help-list" @click="showHelpContent(1)">
            <div class="header">
              <span class="left">购票须知</span>
              <span v-if="helpContentShow===1" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===1" class="help-content">
              <p>1.汽车票产品因受运输公司的不同规定和要求，无法承诺百分之百代购成功。如购票未成功，您的资金将在1-2个工作日内全额安全退还至原支付账户。</p>
              <p>2.目前仅支持购买售卖全价票。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(10)">
            <div class="header">
              <span class="left">取票说明</span>
              <span v-if="helpContentShow===10" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===10" class="help-content">
              <p>提前至少10分钟（节假日等高峰期建议提前）前往选定的上车点，凭购票成功短信，或订单详情中显示的“二维码”、“验证码”等信息乘车。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(11)">
            <div class="header">
              <span class="left">退票、改签说明</span>
              <span v-if="helpContentShow===11" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===11" class="help-content">
              <p>1.若在我司平台申请在线退票，车站将收取10%退票手续费，实际请以平台显示的退款金额为准。</p>
              <p>2.暂不支持改签。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(2)">
            <div class="header">
              <span class="left">
            如何退票,需要什么条件?</span>
              <span v-if="helpContentShow===2" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===2" class="help-content">
              <p>发车时间大于1小时的订单可以申请退款，受运输公司、平台资源等原因影响，退票将收取实际支付金额的10%服务费。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(3)">
            <div class="header">
              <span class="left">退款订单什么时候能退款到账？</span>
              <span v-if="helpContentShow===3" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===3" class="help-content">
              <p>您的资金将在1-2个工作日内全额安全退还至原支付账户。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(4)">
            <div class="header">
              <span class="left">如何确认我的订单是否订票成功?</span>
              <span v-if="helpContentShow===4" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===4" class="help-content">
              <p>我司有专人负责确认，并以微信公众号、短信的方式通知到用户。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(5)">
            <div class="header">
              <span class="left">可以让亲朋好友代购票吗？</span>
              <span v-if="helpContentShow===5" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===5" class="help-content">
              <p>可以的，只需在乘车人里填写您的姓名手机号即可。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(6)">
            <div class="header">
              <span class="left">订票时写错乘客姓名影响乘车吗？</span>
              <span v-if="helpContentShow===6" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===6" class="help-content">
              <p>不影响的，您的乘车人联系电话也可作为凭证。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(7)">
            <div class="header">
              <span class="left">怎么退掉订单中的其中一张票？</span>
              <span v-if="helpContentShow===7" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===7" class="help-content">
              <p>进入退款页面后，可选择需退票的乘车人。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(8)">
            <div class="header">
              <span class="left">错过了发车时间，可以退改签吗?</span>
              <span v-if="helpContentShow===8" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===8" class="help-content">
              <p>目前暂不支持过期退，如有特殊情况请联系电话客服。客服电话:0663-5519299</p>
            </div>
          </div>
          <!-- <div class="help-list" @click="showHelpContent(9)">
            <div class="header">
              <span class="left">错过了发车时间，可以退改签吗？</span>
              <span v-if="helpContentShow===9" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===9" class="help-content">
              <p>1.错过发车时间后是无法退改签的,请注意自己的发车时间.</p>
            </div>
          </div> -->
        </div>
      </div>
    </mt-popup>
    <!-- 绑定手机号 -->
    <mt-popup v-model="phonePickerPageShow" position="center" class="phone_page">
      <slot>
        <p>绑定手机号</p>
        <div class="bind-phone">
          <input v-model="inputPhone" maxlength="11" ref="inputphone" placeholder="输入手机号码" type="tel" name="phone">
          <span @click="clearInputPhone">清空</span>
        </div>
        <button @click="nextStepPhone">下一步</button>
        <p class="gray">点击灰色区域退出</p>
      </slot>
    </mt-popup>
    <!-- 输入验证码 -->
    <mt-popup v-model="codePickerPageShow" position="center" class="phone_page">
      <slot>
        <p>请输入验证码</p>
        <div class="bind-phone">
          <p>{{inputPhone}}
            <template v-if="codeTimeText===60">
              <span @click="nextStepPhone">重新发送</span>
            </template>
            <template v-else>
              <span>{{codeTimeText}}秒</span>
            </template>
          </p>
        </div>
        <vue-input-code :code="inputCode" :number="6" height="50px" :success="InputCodeSuccess"></vue-input-code>
      </slot>
    </mt-popup>
    <div v-show="myModal" @click="quitModal" class="my-modal"></div>
    <footer>
      <a :href="'./ticket.html?datetime='+Date.now()" class="footer" class="footer">
        <!-- <i class="fa fa-home"></i> -->
        <img src="../picture/ticket.png">
        <p>票务</p>
      </a>
      <a :href="'./TicketOrder.html?datetime='+Date.now()" class="footer">
        <!-- <i class="fa fa-sticky-note"></i> -->
        <img src="../picture/cart_order.png">
        <p>订单</p>
      </a>
      <a :href="'./TicketUser.html?datetime='+Date.now()" class="footer active">
        <!-- <i class="fa fa-user"></i> -->
        <img src="../picture/user_blue.png">
        <p>我的</p>
      </a>
    </footer>
  </div>
  <!-- <script type="text/javascript">
  var url = "./bundle-ticketuser.js?" + Date.now();
  var script = document.createElement("script");
  script.src = url;
  document.body.appendChild(script);
  </script> -->
  <script src="./bundle-ticketuser.js?14899842555"></script>
</body>

</html>
