<!DOCTYPE html>
<html lang="en">

<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="IE=edge" http-equiv="X-UA-Compatible" />
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
  <meta name="format-detection" content="telephone=no, email=no"/>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <title>身边票务--我的</title>
</head>

<body>
  <div id="app" v-show="ready" style="display: none;">

    <!-- 头部 -->
    <header class="animated fadeIn" v-show="showHeader">
      <div @click="GoBack" class="left">
        <img src="../picture/back_icon.png">
      </div>
      <div class="home">
        <span v-text="headerTitle"></span>
      </div>
    </header>
    <div class="body">
      <!-- 头部 -->
      <div class="header">
        <img src="../picture/user_bg.png">
        <div @click="showUserInfo" class="left content">
          <p v-text="UserInfo.Nickname"></p>
          <span v-text="UserInfo.Mobile?UserInfo.Mobile:UserInfo.Province+UserInfo.City"></span>
          <span>查看并编辑个人信息</span>
        </div>
        <div class="right content">
          <img :src="UserInfo.Headimgurl">
        </div>
      </div>
      <!-- 其中的列表 -->
      <div class="lists">
        <div @click="showOrderList()" class="linestyle">
          <p>全部订单</p>
          <div><img src="../picture/orders_gray.png"></div>
        </div>
        <div @click="showDiscountList" class="linestyle">
          <p>优惠券</p>
          <div><img src="../picture/coupon_gray.png"></div>
        </div>
        <div @click="showPassengerList" class="linestyle">
          <p>常用联系人</p>
          <div><img src="../picture/contact_person_gray.png"></div>
        </div>
        <a href="tel:111111111111" class="linestyle">
          <p>联系客服</p>
          <div><img src="../picture/phone_gray.png"></div>
        </a>
        <div @click="helpCenter" class="linestyle">
          <p>帮助中心</p>
          <div><img src="../picture/question_gray.png"></div>
        </div>
      </div>
    </div>

    <!-- 全部订单信息 -->
    <mt-popup v-model="orderVisible" position="right" id="order-lists" class="order-lists">
      <div class="lists">
        <div class="order-lists-header">
          <span @click="showOrderList()" :class="UseOrderType===0?'active':''">全部订单</span>
          <span @click="showOrderList(1)" :class="UseOrderType===1?'active':''">未支付</span>
          <span @click="showOrderList(2)" :class="UseOrderType===2?'active':''">已支付</span>
          <span @click="showOrderList(3)" :class="UseOrderType===3?'active':''">待出行</span>
        </div>
        <!-- 订单 -->
        <div class="list" @click="openOrder(index)" v-for="(item,index) in OrderList">
          <div class="ticket-info">
            <div class="left">
              <span v-text="item.Boardtime">08:23</span>
              <span v-text="item.CoName">东方快车</span>
              <span>{{item.Route}}</span>
            </div>
            <div class="center">
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
            </div>
            <div class="right">
              <div class="top">
                <div class="name">
                  <p>{{item.StartPoint}}</p>
                  <p>{{item.EndPoint}}</p>
                </div>
                <div class="info">
                  <p v-text="'¥'+item.TotalPrice"></p>
                  <p v-if="item.IsPay===0">未支付</p>
                  <p style="color:#329be8;" v-else>已支付</p>
                </div>
              </div>
              <div class="bottom">
                <img src="../picture/time.png">
                <p>{{item.Boarddate}}</p>
              </div>
            </div>
          </div>
        </div>
        <div id="last"></div>
      </div>
    </mt-popup>

    <!-- 优惠券 -->
    <mt-popup v-model="discountVisible" position="right" class="action-page">
      <slot>
        <div class="action">
          <div class="action-use">
            <div style="padding-top: 5px;" class="page">
              <!-- 可用优惠券 -->
              <div class="rebate" v-for="(item,index) in Rebate">
                <div class="left">
                  <div class="circle">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                  </div>
                  <div class="title">
                    <p><span>¥</span>{{item.Money}}</p>
                    <span>{{'满'+item.LimitMoney+'可用'}}</span>
                  </div>
                </div>
                <div class="right">
                  <div class="info">
                    <span>{{item.Name}}</span>
                    <span>{{item.StartDate}} 至 {{item.EndDate}}</span>
                  </div>
                  <div class="check">
                    <a :href="'https://ticket.samecity.com.cn/wx/ticket.html?rebateid='+item.Id">立即使用</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </slot>
    </mt-popup>

    <!-- 申请退款 -->
    <mt-popup v-model="refundVisible" position="right" id="refund-lists" class="refund-lists">
      <div class="lists">
        <!-- 列表 -->
        <a class="list" v-for="(item,index) in RefundOrder.RefundList" :href="'https://ticket.samecity.com.cn/wx/TicketOrder.html?orderid='+item.OrderId">
          <div class="left">
            <div class="left-line">
              <span class="left-span">退款号:</span>
              <span class="nowrap" v-text="item.Id"></span>
            </div>
            <div class="left-line">
              <span class="left-span">退款理由:</span>
              <span class="nowrap" v-text="item.Remark"></span>
            </div>
            <div class="left-line">
              <span class="left-span">审核回复:</span>
              <span class="nowrap" v-text="item.Reply?item.Reply:'未回复'"></span>
            </div>
            <div class="left-line">
              <span class="left-span">申请状态:</span>
              <template v-if="item.Status===0">
                <span class="red">审核不过</span>
              </template>
              <template v-if="item.Status===1">
                <span class="blue">审核中</span>
              </template>
              <template v-if="item.Status===2">
                <span class="blue">审核通过待退款</span>
              </template>
              <template v-if="item.Status===3">
                <span class="blue">已退款</span>
              </template>
            </div>
          </div>
          <div class="right">
            <template v-if="item.Status===0">
              <img src="./picture/shenhebuguo.png" class="checking">
            </template>
            <template v-if="item.Status===1">
              <img src="./picture/shenhe.png" class="checking">
            </template>
            <template v-if="item.Status===2">
              <img src="./picture/shenhetongguo.png" class="checking">
            </template>
            <template v-if="item.Status===3">
              <img src="./picture/refund.png" class="checking">
            </template>
          </div>
        </a>
        <div id="last_refund"></div>
      </div>
    </mt-popup>

    <!-- 乘客 -->
    <mt-popup v-model="passengerVisible" position="right" class="action-page">
      <slot>
        <div class="action">
          <div class="action-select">
            <div class="line" v-for="(item,index) in Passenger">
              <div class="left">
                <p>{{item.Name}}</p>
              </div>
              <div class="center">
                <p>{{item.Mobile}}</p>
              </div>
              <div @click="showChaPassenger(index)" class="right"><img src="../picture/edit.png"></div>
            </div>
          </div>
          <p class="refresh">没有乘客信息?来下面添加吧~ </p>
          <div class="action-body">
            <!-- 点击新增乘客 -->
            <div class="write-info">
              <div @click="showAddPassenger" class="line">
                <span>添加新乘车人</span>
                <div class="img"><img src="../picture/add_passenger.png"></div>
              </div>
            </div>
            <!-- 添加乘客 -->
            <div v-show="showpassengeraction===1" class="add-action animated zoomIn">
              <div class="line">
                <input type="text" v-model="passengerName" name="passengerName" placeholder="请填写真实姓名">
              </div>
              <div class="line">
                <input type="text" v-model="passengerPhone" name="passengerPhone" placeholder="选填(可用于联系)">
                <button @click="addPassenger(0)"><i class="fa fa-plus-circle"></i> 添加</button>
              </div>
            </div>
            <!-- 修改乘客 -->
            <div v-show="showpassengeraction===2" class="add-action animated zoomIn">
              <div class="line">
                <input type="text" v-model="passengerName" name="passengerName" placeholder="请填写真实姓名">
              </div>
              <div class="line">
                <input type="text" v-model="passengerPhone" name="passengerPhone" placeholder="选填(可用于联系)">
                <button @click="addPassenger(1)"><i class="fa fa-plus-circle"></i> 修改</button>
              </div>
            </div>
          </div>
        </div>
      </slot>
    </mt-popup>

    <!-- 用户信息 -->
    <mt-popup v-model="userVisible" position="right" id="user-lists" class="user-lists">
      <div class="lists">
        <div class="info-man">
          <div class="info-man-line info">
            <span class="left">ID:</span>
            <span class="gray" v-text="UserInfo.Alias_Id"></span>
          </div>
          <div @click="edit(0)" class="info-man-line info">
            <span class="left">昵称:</span>
            <span class="gray" v-text="UserInfo.Nickname"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
          <!-- <div class="info-man-line info">
            <span class="left">姓名:</span>
            <span class="gray" v-text="UserInfo.Name?UserInfo.Name:'未设置'"></span>
            <div @click="edit(1)" class="right"><i class="fa fa-edit"></i></div>
          </div> -->
          <div @click="edit(2)" class="info-man-line info">
            <span class="left">绑定手机:</span>
            <span class="gray" v-text="UserInfo.Mobile?UserInfo.Mobile:'未设置'"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
          <div @click="edit(3)" class="info-man-line info">
            <span class="left">性别:</span>
            <span class="gray" v-text="UserInfo.Sex===1?'男':'女'"></span>
            <div class="right"><img src="../picture/edit.png"></div>
          </div>
        </div>
      </div>
    </mt-popup>
    
    <!-- 帮助中心 -->
    <mt-popup v-model="helpVisible" position="right" id="help-lists" class="help-lists">
      <div class="lists">
        <!-- 列表 -->
        <div class="help">
          <div class="help-list" @click="showHelpContent(1)">
            <div class="header">
              <span class="left">购票须知</span>
              <span v-if="helpContentShow===1" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===1" class="help-content">
              <p>1.汽车票产品因受全国各客运站的不同规定和要求，无法承诺百分之百代购成功。如购票未成功，您的资金将在1-7个工作日内全额安全退还至原支付账户。</p>
              <p>2.目前仅支持购买售卖全价票（含成人及身高超过1.50米的儿童).</p>
              <p>3.暂不支持儿童票、免票（携儿童）、学生票、优待票等特殊票种的购买，请乘客根据需要在出发车站自行购买，携带儿童数量有限，请注意提前至车站报备。</p>
              <p>4.提前至少30分钟（节假日等高峰期建议提前一小时）凭购票成功短信，或订单详情中显示的“取票订单号”、“取票号”、“取票密码”等信息前往出发车站取票，并请准备好预订时的身份证件以备查。建议优先在自助取票机取票，如无自助取票机，请将取票信息提供给售票窗口或服务台的工作人员取票.</p>
              <p>5.套餐类产品中汽车票及附加的优惠券、门票等均不支持在线退改，如需退车票，请至车站取票后办理.</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(2)">
            <div class="header">
              <span class="left">
            如何退票,需要什么条件?</span>
              <span v-if="helpContentShow===2" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===2" class="help-content">
              <p>1.若在我司申请在线退票，车站将收取10%-20%退票手续费，实际请以短信通知金额为准</p>
              <p>2.暂不支持改签，如需改签，请在发车前到出发车站按规定办理或退票后重新购买。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(3)">
            <div class="header">
              <span class="left">退款订单什么时候能退款到账？</span>
              <span v-if="helpContentShow===3" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===3" class="help-content">
              <p>1.订单支付后,在发车前申请的退款将会人工审核并微信通知结果,后台确认退款后微信将会在1-3个工作日原路退款至支付账户.</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(4)">
            <div class="header">
              <span class="left">订票成功后为什么没显示座位号信息？</span>
              <span v-if="helpContentShow===4" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===4" class="help-content">
              <p>1.由于订票时无法在线选座，因此取票信息中不包含座位号，您去车站取票时取票系统会自动生成座位号。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(5)">
            <div class="header">
              <span class="left">可以让亲朋好友代购票吗？</span>
              <span v-if="helpContentShow===5" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===5" class="help-content">
              <p>1.目前购买汽车票无需实名制，只需提供购买取票手机号,乘客可以由亲友代为购票呢。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(6)">
            <div class="header">
              <span class="left">订单支付完成后页面还是显示正在付款？</span>
              <span v-if="helpContentShow===6" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===6" class="help-content">
              <p>1.这种情况一般是由于数据返回有延误，您可以登录用户中心后台查看订单状态，如果发现订单状态仍然显示为待付款，您可以联系客服人员解决问题。</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(7)">
            <div class="header">
              <span class="left">订票时乘客姓名写错了影响取票吗？</span>
              <span v-if="helpContentShow===7" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===7" class="help-content">
              <p>1.姓名错误不影响取票,手机号如果错误可以在个人中心修改.</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(8)">
            <div class="header">
              <span class="left">怎么推掉订单中的其中一张票?</span>
              <span v-if="helpContentShow===8" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===8" class="help-content">
              <p>1.如果票未取,可以在订单页点击待使用,找到你需要退票的订单,再点击最下面的申请退款,选择你所需要退票的乘客,选择好后点击确定,然后输入申请理由,等待后台客服审核.</p>
            </div>
          </div>
          <div class="help-list" @click="showHelpContent(9)">
            <div class="header">
              <span class="left">错过了发车时间，可以退改签吗？</span>
              <span v-if="helpContentShow===9" class="right"><i class="fa fa-caret-up"></i></span>
              <span v-else class="right"><i class="fa fa-caret-down"></i></span>
            </div>
            <div v-show="helpContentShow===9" class="help-content">
              <p>1.错过发车时间后是无法退改签的,请注意自己的发车时间.</p>
            </div>
          </div>
        </div>
      </div>
    </mt-popup>

    <div v-show="myModal" class="my-modal"></div>
    <footer>
      <a :href="'./ticket.html?datetime='+Date.now()" class="footer" class="footer">
        <!-- <i class="fa fa-home"></i> -->
        <img src="./picture/ticket.png">
        <p>票务</p>
      </a>
      <a :href="'./TicketOrder.html?datetime='+Date.now()" class="footer">
        <!-- <i class="fa fa-sticky-note"></i> -->
        <img src="./picture/cart_order.png">
        <p>订单</p>
      </a>
      <a :href="'./TicketUser.html?datetime='+Date.now()" class="footer active">
        <!-- <i class="fa fa-user"></i> -->
        <img src="./picture/user_blue.png">
        <p>我的</p>
      </a>
    </footer>
  </div>
  <script src="./bundle-ticketuser.js"></script>
</body>

</html>
