<!DOCTYPE html>
<html lang="en">

<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="IE=edge" http-equiv="X-UA-Compatible" />
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <title>身边票务--订单</title>
</head>

<body>
  <div id="app" v-show="ready" style="display: none;">
    <!-- 头部 -->
    <header>
      <span :class="{active:selected===1}" @click="selectPage(1)">待支付</span>
      <span :class="{active:selected===2}" @click="selectPage(2)">待使用</span>
    </header>
    <!-- 第一个页面 -->
    <div class="page" v-show="selected===1">
      <div class="body">
        <!-- 没有订单数据 -->
        <div class="no-data" v-if="noDataShow">
          <p>这里空空如也</p>
        </div>
        <!-- 订单数据 -->
        <div class="order" v-else>
          <!-- 订单列表 -->
          <div class="list" @click="openOrder(index)" v-for="(item,index) in OrderList">
            <div class="ticket-info">
              <div class="left">
                <span v-text="item.Boardtime">08:23</span>
                <span v-text="item.CoName">东方快车</span>
                <span>{{item.Route}}</span>
              </div>
              <div class="center">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
              </div>
              <div class="right">
                <div class="top">
                  <div class="name">
                    <p>{{item.StartPoint}}</p>
                    <p>{{item.EndPoint}}</p>
                  </div>
                  <div class="info">
                    <p v-text="'¥'+item.TotalPrice"></p>
                    <p v-if="item.Status===0">订单失效</p>
                    <p style="color:#329be8;" v-else>未支付</p>
                  </div>
                </div>
                <div class="bottom">
                  <img src="../picture/time.png">
                  <p>{{item.Boarddate}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="last"></div>
    </div>
    <!-- 第2个页面 -->
    <div class="page" v-show="selected===2">
      <div class="body">
        <!-- 没有订单数据 -->
        <div class="no-data" v-if="noDataShow1">
          <p>这里空空如也</p>
        </div>
        <!-- 订单数据 -->
        <div class="order" v-else>
          <!-- 订单列表 -->
          <div class="list" @click="openOrder(index)" v-for="(item,index) in OrderList1">
            <div class="ticket-info">
              <div class="left">
                <span v-text="item.Boardtime">08:23</span>
                <span v-text="item.CoName">东方快车</span>
                <span>{{item.Route}}</span>
              </div>
              <div class="center">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
              </div>
              <div class="right">
                <div class="top">
                  <div class="name">
                    <p>{{item.StartPoint}}</p>
                    <p>{{item.EndPoint}}</p>
                  </div>
                  <div class="info">
                    <p v-text="'¥'+item.TotalPrice"></p>
                    <p v-if="item.IsPay===0">未支付</p>
                    <p style="color:#329be8;" v-else>已支付</p>
                  </div>
                </div>
                <div class="bottom">
                  <img src="../picture/time.png">
                  <p>{{item.Boarddate}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="last1"></div>
    </div>
    <!-- 查看订单信息 -->
    <mt-popup v-model="orderVisible" position="right" class="action-page">
      <slot>
        <div class="action">
          <!-- 未支付 -->
          <template v-if="OrderDetail.IsPay===0 && OrderDetail.Status===1">
            <div class="page-header">
              <div @click="goback"><img src="../picture/back_icon.png"></div>
              <span style="font-size:16px;" class="center">预订成功,请在半小时内支付订单 {{countdownTime}}</span>
            </div>
          </template>
          <!-- 已支付 -->
          <template v-if="OrderDetail.IsPay===1 && OrderDetail.Status>0">
            <div class="page-header active">
              <div @click="goback"><img src="../picture/back_icon.png"></div>
              <span @click="openCode" style="font-size:16px;margin-left:5px;" class="center">扫描二维码可及时获取车票信息推送</span>
              <p @click="openCode" style="height:50px;line-height: 50px;width:30px;"><img style="width:20px;height:20px;margin-top: 15px;" src="../picture/code.png"></span>
              </p>
          </template>
          <div class="action-body">
            <!-- 票信息 -->
            <div class="ticket-info">
              <div class="left">
                <span v-text="OrderDetail.Boardtime">08:23</span>
                <span v-text="OrderDetail.CoName">东方快车</span>
                <span>{{OrderDetail.Route}}</span>
              </div>
              <div class="center">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
              </div>
              <div class="right">
                <div class="top">
                  <div class="name">
                    <p>{{OrderDetail.StartPoint}}</p>
                    <p>{{OrderDetail.EndPoint}}</p>
                  </div>
                  <div class="info"></div>
                </div>
                <div class="bottom">
                  <img src="../picture/time.png">
                  <p>{{OrderDetail.Boarddate+" "+OrderDetail.Boardtime}}</p>
                </div>
              </div>
            </div>
            <!-- 乘客信息 -->
            <div class="passenger-info">
              <div class="passenger-selected">
                <div class="line" v-for="(item,index) in passenger">
                  <span style="margin-left:10px;" class="center">{{item.Name}}</span>
                  <span style="margin-right:10px;" class="right">{{item.Mobile}}</span>
                </div>
              </div>
            </div>
            <!-- 手机号 -->
            <div class="write-info">
              <div class="line">
                <span style="color:rgb(20,20,20)">{{OrderDetail.Linkmanid+' (取票人号码)'}}</span>
                <div class="img"><img src="../picture/phone.png"></div>
              </div>
            </div>
            <!-- 上车点备注 -->
            <div class="write-info">
              <div class="line">
                <span style="color:rgb(20,20,20)">{{OrderDetail.Remark?OrderDetail.Remark:OrderDetail.StartAddress}}</span>
                <div class="img"><img src="../picture/green_station.png"></div>
              </div>
            </div>
            <!-- 旅行备注 -->
            <div class="write-info">
              <div class="line">
                <span style="color:rgb(20,20,20)">{{OrderDetail.JourneyRmk?OrderDetail.JourneyRmk:'系统默认备注'}}</span>
                <div class="img"><img src="../picture/edit.png"></div>
              </div>
            </div>
            <!-- 订单信息 -->
            <div class="pay-ticket-info">
              <p>订单信息</p>
              <p>订单编号:{{OrderDetail.Id}}</p>
              <p>下单日期:{{OrderDetail.CTime}}</p>
            </div>
            <!-- 立即支付 -->
            <div class="pay">
              <div class="left">
                <p>订单总价<span v-text="'¥'+OrderDetail.TotalPrice"></span></p>
              </div>
              <div class="right">
                <!-- 未支付 -->
                <template v-if="OrderDetail.IsPay===0 && OrderDetail.Status===1" @click="payMoney">
                  <span @click="cancelOrder">取消订单</span>
                  <button @click="payMoney">立即支付</button>
                </template>
                <!-- 已支付 -->
                <template v-if="OrderDetail.IsPay===1 && OrderDetail.Status>0">
                  <span @click="showSelectPassenger">申请退款</span>
                  <button>已支付</button>
                </template>
              </div>
            </div>
          </div>
          </div>
      </slot>
    </mt-popup>
    <!-- 退款人选择 -->
    <mt-popup v-model="refundPassenger" position="right" class="action-page">
      <slot>
        <div class="action">
          <div class="page-header" style="background-color: #2196F3;">
            <div @click="goback"><img src="../picture/back_icon.png"></div>
            <span style="font-size:16px;" class="center">退票服务</span>
          </div>
        </div>
        <div class="action-body" style="margin-top: 10px;">
          <a class="contact" href="tel:111111111111">
            <div class="left">
              <p>信息失误,联系客服修改乘车信息</p>
              <span>其实上车点或者乘车人可以联系客服修改哦~</span>
              <span>在这里可以修改乘车人,但是不能删减乘车人</span>
            </div>
            <div class="right"><img src="../picture/phone.png"></div>
          </a>
          <!-- 选择退款人 -->
          <div class="refund">
            <p>坚决退票,支付10%的服务费用</p>
            <span>退票我们需要收取10%工本服务费哦~请三思</span>
          </div>
          <div class="passenger">
            <mt-checklist title="退款人选择" v-model="selectPassenger" :options="optionsPassenger">
            </mt-checklist>
            <button @click="checkSelectPassenger" class="btn">确定</button>
          </div>
        </div>
      </slot>
    </mt-popup>
    <!-- 扫描二维码 -->
    <mt-popup v-model="codePopupVisible" class="code-popup-visible">
      <slot>
        <img src="./picture/qrcode_for_gh_c94040df86a5_430.jpg">
      </slot>
    </mt-popup>
    <footer>
      <a :href="'./ticket.html?datetime='+refreshLink[0]" class="footer">
        <!-- <i class="fa fa-home"></i> -->
        <img src="./picture/ticket.png">
        <p>票务</p>
      </a>
      <a :href="'./TicketOrder.html?datetime='+refreshLink[1]" class="footer active">
        <!-- <i class="fa fa-sticky-note"></i> -->
        <img src="./picture/cart_order_active.png">
        <p>订单</p>
      </a>
      <a :href="'./TicketUser.html?datetime='+refreshLink[2]" class="footer">
        <!-- <i class="fa fa-user"></i> -->
        <img src="./picture/user.png">
        <p>我的</p>
      </a>
    </footer>
    </div>
    <script src="./bundle-ticketorder.js"></script>
</body>

</html>
